#!/bin/bash

LC_ALL=C
export LC_ALL

NM_HOME=$(dirname `dirname $0`)
NM_HOME="${NM_HOME%/}/"

. ${NM_HOME}auto/options
. ${NM_HOME}auto/init


test -d "$NM_OBJS" || mkdir -p $NM_OBJS

echo > $NM_AUTO_HEADERS_H
echo > $NM_AUTOCONF_ERR


echo "#define NM_CONFIGURE \"$NM_CONFIGURE\"" > $NM_AUTO_CONFIG_H

if test -z "$NM_PLATFORM"; then
  echo "checking for OS"
  
  NM_SYSTEM=`uname -s 2>/dev/null`
  NM_RELEASE=`uname -r 2>/dev/null`
  NM_MACHINE=`uname -m 2>/dev/null`
  
  echo " + $NM_SYSTEM $NM_RELEASE $NM_MACHINE"
  
	case $NM_SYSTEM in
		MSYS_NT-*)
			NM_RELEASE=${NM_SYSTEM:8}
			NM_SYSTEM=${NM_SYSTEM:0:7}
		;;
	esac
		
  NM_PLATFORM="$NM_SYSTEM:$NM_RELEASE:$NM_MACHINE";
  
else
  echo "building for $NM_PLATFORM"
  NM_SYSTEM=$NM_PLATFORM
fi



. ${NM_HOME}auto/cc/conf

. ${NM_HOME}auto/os/conf


case ".$NM_PREFIX" in
	.)
    NM_PREFIX=${NM_PREFIX:-/opt/run}
    have=NM_PREFIX value="\"$NM_PREFIX/\"" . ${NM_HOME}auto/define
	;;

	.!)
    NM_PREFIX=
	;;

	*)
    have=NM_PREFIX value="\"$NM_PREFIX/\"" . ${NM_HOME}auto/define
	;;
esac


. ${NM_HOME}auto/make

. ${NM_HOME}auto/install


. ${NM_HOME}auto/summary
